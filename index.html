<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Trevor Drozd — Backend & Automation Engineer</title>
  <meta name="description" content="Backend & Automation Engineer — Python • FastAPI • Docker/CI • Ops‑savvy" />
  
  <!-- Open Graph meta tags for social sharing -->
  <meta property="og:title" content="Trevor Drozd — Backend & Automation Engineer" />
  <meta property="og:description" content="Proof‑of‑work projects: FastAPI, webhooks, Redis queues, CI, observability." />
  <meta property="og:type" content="website" />
  
  <link rel="icon" href="/public/favicon.ico" />
  
  <!-- Styles & Fonts -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif; }
  </style>
</head>
<body class="bg-neutral-950 text-neutral-100">
  <!-- Navigation -->
  <header class="sticky top-0 z-10 backdrop-blur bg-neutral-950/60 border-b border-neutral-800">
    <div class="mx-auto max-w-5xl px-4 py-3 flex items-center justify-between">
      <a href="#" class="font-semibold tracking-tight">Trevor Drozd</a>
      <nav class="flex gap-4 text-neutral-300 text-sm">
        <a class="hover:text-white" href="#work">Work</a>
        <a class="hover:text-white" href="#writing">Writing</a>
        <a class="hover:text-white" href="#contact">Contact</a>
      </nav>
    </div>
  </header>

  <!-- Hero Section -->
  <section class="mx-auto max-w-5xl px-4 py-16">
    <div class="grid md:grid-cols-2 gap-8 items-center">
      <div>
        <h1 class="text-3xl md:text-5xl font-bold leading-tight">
          Backend & Automation Engineer
        </h1>
        <div class="mt-4 text-neutral-300">
          <p>Python • FastAPI • Docker/CI • Observability. I build small, production‑ready services with clean docs, tests, and demos.</p>
          <h4 class="mt-2 font-semibold">I build internal tools that remove friction.</h4>
        </div>
        <div class="mt-6 flex flex-wrap gap-3">
          <a href="https://github.com/tcdrozd" target="_blank" rel="noopener noreferrer" class="px-4 py-2 rounded-xl bg-white text-neutral-900 font-semibold">GitHub</a>
          <a href="/public/resume.pdf" class="px-4 py-2 rounded-xl bg-neutral-800 border border-neutral-700">Resume</a>
          <a href="#contact" class="px-4 py-2 rounded-xl bg-neutral-800 border border-neutral-700">Contact</a>
        </div>
      </div>
      <div class="rounded-2xl border border-neutral-800 p-6 bg-gradient-to-br from-neutral-900 to-neutral-950">
        <h2 class="text-lg font-semibold">Highlights</h2>
        <ul class="mt-3 space-y-2 text-sm text-neutral-300 list-disc list-inside">
          <li>Webhook receiver with idempotency + retries + structured logging</li>
          <li>FastAPI service with background jobs (RQ/Celery) & Redis</li>
          <li>GitHub Actions CI: tests, docker build, lint, smoke deploy</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- Project Filters -->
  <section class="mx-auto max-w-5xl px-4">
    <div class="flex items-center justify-between gap-3">
      <h2 class="text-sm font-semibold text-neutral-300">Filters</h2>
      <button id="toggleTags"
        class="sm:hidden px-3 py-1 rounded-xl border border-neutral-700 text-sm hover:bg-neutral-800"
        aria-label="Toggle tag visibility">
        Show tags
      </button>
    </div>

    <div id="tagWrap" class="mt-3 sm:mt-0">
      <div class="flex flex-wrap gap-2 sm:gap-2" id="tagBar" role="toolbar" aria-label="Project tags filter"></div>
    </div>
  </section>

  <!-- Projects Grid -->
  <section id="work" class="mx-auto max-w-5xl px-4 py-10">
    <h2 class="text-2xl font-bold">Selected Work</h2>
    <div id="projects" class="mt-6 grid sm:grid-cols-2 gap-6" role="list" aria-label="Project list"></div>
  </section>

  <!-- Writing Section -->
  <section id="writing" class="mx-auto max-w-5xl px-4 py-10 border-t border-neutral-900">
    <h2 class="text-2xl font-bold">Writing & Notes</h2>
    <p class="mt-3 text-neutral-300">Short write‑ups, ADRs, and diagrams. (Wire this to Wiki.js or add markdown links.)</p>
    <ul class="mt-4 space-y-2 text-neutral-300 text-sm" id="posts">
      <!-- Content populated via JavaScript if needed -->
    </ul>
  </section>

  <!-- Contact Section -->
  <section id="contact" class="mx-auto max-w-5xl px-4 py-10 border-t border-neutral-900">
    <h2 class="text-2xl font-bold">Contact</h2>
    <p class="mt-3 text-neutral-300">
      <a class="underline" href="mailto:trcharlesd@gmail.com">trcharlesd@gmail.com</a> ·
      <a class="underline" href="https://www.linkedin.com/in/trevor-drozd/" target="_blank" rel="noopener noreferrer">LinkedIn</a> ·
      <a class="underline" href="https://www.github.com/tcdrozd" target="_blank" rel="noopener noreferrer">GitHub</a>
    </p>
  </section>

  <!-- Footer -->
  <footer class="mx-auto max-w-5xl px-4 py-10 text-neutral-500 text-xs">
    <p>© <span id="year"></span> Trevor Drozd</p>
  </footer>

  <script>
    // ==============================================
    // PROJECTS DATA & FILTERING SYSTEM
    // ==============================================
    
    // State management
    const TAGS = new Set();
    const selectedTags = new Set();
    let tagsExpanded = false;

    // Check if viewport is desktop (≥ 640px)
    function isDesktop() {
      return window.matchMedia('(min-width: 640px)').matches;
    }

    // Toggle tag visibility on mobile
    function updateTagVisibility() {
      const wrap = document.getElementById('tagWrap');
      const btn = document.getElementById('toggleTags');
      if (!wrap || !btn) return;

      if (isDesktop()) {
        wrap.style.display = '';
        btn.style.display = 'none';
        return;
      }

      btn.style.display = '';
      wrap.style.display = tagsExpanded ? '' : 'none';
      btn.textContent = tagsExpanded ? 'Hide tags' : 'Show tags';
    }

    // Event listener for mobile tag toggle button
    document.getElementById('toggleTags')?.addEventListener('click', () => {
      tagsExpanded = !tagsExpanded;
      updateTagVisibility();
    });

    // Update tag visibility on window resize
    window.addEventListener('resize', updateTagVisibility);

    /**
     * Normalize project data from JSON
     * Supports both legacy (tech/highlights) and current (tags/notes) schemas
     */
    function normalizeProject(project) {
      const tags = Array.isArray(project.tags) 
        ? project.tags 
        : (Array.isArray(project.tech) ? project.tech : []);
      
      const notes = Array.isArray(project.notes) 
        ? project.notes 
        : (Array.isArray(project.highlights) ? project.highlights : []);
      
      const links = (project.links && typeof project.links === 'object') 
        ? project.links 
        : {};
      
      const summary = (project.summary ?? project.description ?? '').toString();
      
      return { 
        ...project, 
        tags, 
        notes, 
        links, 
        summary 
      };
    }

    /**
     * Fetch projects from JSON file
     */
    async function fetchProjects() {
      try {
        const res = await fetch('/data/projects.json', { cache: 'no-store' });
        if (!res.ok) {
          throw new Error(`Failed to fetch projects (HTTP ${res.status})`);
        }
        const raw = await res.json();
        
        if (!Array.isArray(raw)) {
          throw new Error('projects.json must be a JSON array');
        }
        
        return raw.map(normalizeProject);
      } catch (error) {
        console.error('Error loading projects:', error);
        throw error;
      }
    }

    /**
     * Render the tag filter bar
     */
    function renderTagBar(projects) {
      // Clear and rebuild tag set
      TAGS.clear();
      projects.forEach(project => {
        project.tags.forEach(tag => TAGS.add(tag));
      });

      const tagBar = document.getElementById('tagBar');
      if (!tagBar) return;

      tagBar.innerHTML = '';

      // Create tag buttons
      Array.from(TAGS).sort().forEach(tag => {
        const button = document.createElement('button');
        const isActive = selectedTags.has(tag);
        
        button.className = isActive
          ? 'px-3 py-1 rounded-full border border-neutral-600 bg-neutral-800 text-sm'
          : 'px-3 py-1 rounded-full border border-neutral-700 text-sm hover:bg-neutral-800';
        
        button.textContent = tag;
        button.setAttribute('aria-pressed', isActive);
        
        button.addEventListener('click', () => {
          if (selectedTags.has(tag)) {
            selectedTags.delete(tag);
          } else {
            selectedTags.add(tag);
          }
          loadAndRender();
        });
        
        tagBar.appendChild(button);
      });

      updateTagVisibility();
    }

    /**
     * Render projects grid
     */
    function renderProjects(projects) {
      const grid = document.getElementById('projects');
      if (!grid) return;

      // Filter projects by selected tags
      const activeProjects = selectedTags.size
        ? projects.filter(project => 
            project.tags.some(tag => selectedTags.has(tag)))
        : projects;

      // Handle empty state
      if (activeProjects.length === 0) {
        grid.innerHTML = `
          <div class="col-span-2 text-center py-8 text-neutral-400">
            No projects match the selected filters.
          </div>
        `;
        return;
      }

      // Generate project cards
      grid.innerHTML = activeProjects.map(project => `
        <article class="rounded-2xl border border-neutral-800 p-5 bg-neutral-900/40">
          <h3 class="text-lg font-semibold">${project.title || 'Untitled Project'}</h3>
          <p class="mt-2 text-sm text-neutral-300">${project.summary}</p>

          ${project.tags.length ? `
            <div class="mt-3 flex flex-wrap gap-2">
              ${project.tags.map(tag => `
                <span class="text-xs px-2 py-1 rounded-full bg-neutral-800 border border-neutral-700">
                  ${tag}
                </span>
              `).join('')}
            </div>
          ` : ''}

          <div class="mt-4 flex flex-wrap gap-3 text-sm">
            ${project.links.repo ? `
              <a class="underline" target="_blank" rel="noopener noreferrer" href="${project.links.repo}">
                Repo
              </a>
            ` : ''}
            ${project.links.demo ? `
              <a class="underline" target="_blank" rel="noopener noreferrer" href="${project.links.demo}">
                Demo
              </a>
            ` : ''}
            ${project.links.loom ? `
              <a class="underline" target="_blank" rel="noopener noreferrer" href="${project.links.loom}">
                Loom
              </a>
            ` : ''}
          </div>

          ${project.impact ? `
            <p class="mt-3 text-xs text-neutral-400">
              <strong>Impact:</strong> ${project.impact}
            </p>
          ` : ''}

          ${project.notes.length ? `
            <ul class="mt-3 text-xs text-neutral-400 list-disc list-inside">
              ${project.notes.map(note => `<li>${note}</li>`).join('')}
            </ul>
          ` : ''}
        </article>
      `).join('');
    }

    /**
     * Main function to load data and render UI
     */
    async function loadAndRender() {
      const grid = document.getElementById('projects');
      
      try {
        const projects = await fetchProjects();
        renderTagBar(projects);
        renderProjects(projects);
      } catch (error) {
        console.error('Failed to load projects:', error);
        if (grid) {
          grid.innerHTML = `
            <div class="col-span-2 text-center py-8 text-red-300">
              Failed to load projects. Please check the console for details.
            </div>
          `;
        }
      }
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      // Set current year in footer
      const yearElement = document.getElementById('year');
      if (yearElement) {
        yearElement.textContent = new Date().getFullYear();
      }
      
      // Load and render projects
      loadAndRender();
    });
  </script>
</body>
</html>